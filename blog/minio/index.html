<!doctype html><html lang=en><head><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><title>[PL] WÅ‚asny Amazon S3 na Mikrusie? ~ lemonsh's website</title><link href=/main.css rel=stylesheet><link href=https://lemonsh.moe/rss.xml rel=alternate title=RSS type=application/rss+xml><body><header><h1>[PL] WÅ‚asny Amazon S3 na Mikrusie?</h1><p>ğŸ“… 2022-01-08â€‚ ğŸ•‘ 3min</header><nav><a href=/><navitem>home</navitem></a><a href=/projects/><navitem>projects</navitem></a><a href=/blog/><navitem>blog</navitem></a></nav><hr><p><em>This article is written in Polish, for the <a rel="noopener noreferrer" href=https://mikr.us target=_blank>Mikrus</a> project.</em><h1 id=czym-jest-minio>Czym jest MinIO?</h1><p><em><strong>MinIO</strong></em> to napisany w Go otwartoÅºrÃ³dÅ‚owy serwer <em>object storage</em> kompatybilny z <strong>Amazon S3</strong>. Posiada bardzo duÅ¼e moÅ¼liwoÅ›ci konfiguracji, a jego instalacja jest doÅ›Ä‡ prosta.<p>W tym poÅ›cie, chciaÅ‚bym opisaÄ‡ jego instalacjÄ™ na <a rel="noopener noreferrer" href=https://mikr.us target=_blank>Mikrusie</a></p><span id=continue-reading></span><h1 id=instalacja>Instalacja</h1><p>InstalacjÄ™ przeprowadzimy na nastÄ™pujÄ…cej konfiguracji:<ul><li><em>Mikrus</em>, najlepiej 2.0 lub 3.0<li><em>Alpine Linux</em> - bardzo lekka, szybka i nieskomplikowana w budowie dystrybucja Linuxa<li><em>Mikrusowy Storage</em> - <em>Mikrusy</em> nie majÄ… zbyt duÅ¼o "wÅ‚asnego" dysku, a zdalny storage odpada ze wzglÄ™du na charakter usÅ‚ugi jakÄ… jest S3<li><em>WÅ‚asna domena</em> - potrzebna do SSL, a mikrusowa subdomena siÄ™ nie nada ze wzglÄ™du na ograniczenia Cloudflare co do rozmiaru zapytania HTTP</ul><h2 id=porty-uzyte-w-poradniku>Porty uÅ¼yte w poradniku</h2><p>Ta lista powinna pomÃ³c ci uzupeÅ‚niÄ‡ pliki konfiguracyjne odpowiednimi portami<ul><li><strong>9000</strong> - domyÅ›lny, <em>wewnÄ™trzny</em> port MinIO<li><strong>9001</strong> - domyÅ›lny, <em>wewnÄ™trzny</em> port MinIO Console<li><strong>12345</strong> - <em>zewnÄ™trzny</em> port z <a href="https://mikr.us/panel?a=ports" rel="noopener noreferrer" target=_blank>panelu Mikrusa</a></ul><h2 id=rekordy-dns>Rekordy DNS</h2><p>StwÃ³rz dwa rekordy:<table><thead><tr><td>Typ<td>Nazwa<td>Adres<tbody><tr><td>CNAME<td>minio<td>srvXX.mikr.us<tr><td>CNAME<td>console.minio<td>srvXX.mikr.us</table><p>ZamieÅ„ <em>srvXX</em> na adres serwera twojego Mikrusa (np. srv08.mikr.us). BÄ™dziesz musiaÅ‚ ogarnÄ…Ä‡ teÅ¼ certyfikat SSL dla tych dwÃ³ch rekordÃ³w i umieÅ›ciÄ‡ go w <em>/etc/ssl/minio/</em> (patrz. <em>Konfiguracja reverse proxy</em>);<hr><p>MinIO jest dostÄ™pny jako pakiet Alpine, lecz uÅ¼yjemy binarki, gdyÅ¼ po pierwsze, jest to najnowsza wersja (a MinIO jest <em>bardzo</em> czÄ™sto aktualizowany), a po drugie, taki sposÃ³b instalacji zaleca producent.<p>W tym celu, wykonaj nastÄ™pujÄ…ce polecenia <strong>jako root</strong>:<pre class="language-bash z-code" data-lang=bash><code class=language-bash data-lang=bash><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">apk</span></span><span class="z-meta z-function-call z-arguments z-shell"> add curl</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">curl</span></span><span class="z-meta z-function-call z-arguments z-shell"> https://dl.min.io/server/minio/release/linux-amd64/minio<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>o</span> /usr/bin/minio</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">chmod</span></span><span class="z-meta z-function-call z-arguments z-shell"> +x /usr/bin/minio</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">addgroup</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>S</span> minio</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">adduser</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>S</span><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>D</span><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>h</span> /var/lib/minio<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>s</span> /sbin/nologin<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>G</span> minio<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>g</span> minio minio</span>
</span></code></pre><p>MinIO nie posiada wÅ‚asnego skryptu OpenRC, wiÄ™c napisaÅ‚em swÃ³j. UmieÅ›Ä‡ go w <em>/etc/init.d/minio</em>:<pre class="language-bash z-code" data-lang=bash><code class=language-bash data-lang=bash><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell">!/sbin/openrc-run</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">name</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell"><span class="z-string z-quoted z-single z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">'</span>MinIO Server<span class="z-punctuation z-definition z-string z-end z-shell">'</span></span></span>
</span><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">command</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell">/usr/bin/minio</span>
</span><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">command_args</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell"><span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>server --address <span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">MINIO_ADDR</span></span> --console-address <span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">MINIO_CONSOLE_ADDR</span></span> <span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">MINIO_VOLUME</span></span><span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span>
</span><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">command_user</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell"><span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>minio:minio<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span>
</span><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">command_background</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell">true</span>
</span><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">pidfile</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell"><span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>/run/<span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-punctuation z-section z-expansion z-parameter z-begin z-shell">{</span></span><span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-variable z-other z-readwrite z-shell">RC_SVCNAME</span></span><span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-section z-expansion z-parameter z-end z-shell">}</span></span>.pid<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span>
</span><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">output_log</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell"><span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>/var/log/<span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-punctuation z-section z-expansion z-parameter z-begin z-shell">{</span></span><span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-variable z-other z-readwrite z-shell">RC_SVCNAME</span></span><span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-section z-expansion z-parameter z-end z-shell">}</span></span>.log<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span>
</span><span class="z-source z-shell z-bash">
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function z-shell"><span class="z-entity z-name z-function z-shell">depend</span><span class="z-punctuation z-section z-parens z-begin z-shell">(</span><span class="z-punctuation z-section z-parens z-end z-shell">)</span> <span class="z-punctuation z-section z-braces z-begin z-shell">{</span>
</span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function z-shell">    <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">need</span></span><span class="z-meta z-function-call z-arguments z-shell"> net</span>
</span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function z-shell">    <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">use</span></span><span class="z-meta z-function-call z-arguments z-shell"> logger</span>
</span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function z-shell"><span class="z-punctuation z-section z-braces z-end z-shell">}</span></span>
</span><span class="z-source z-shell z-bash">
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function z-shell"><span class="z-entity z-name z-function z-shell">start_pre</span><span class="z-punctuation z-section z-parens z-begin z-shell">(</span><span class="z-punctuation z-section z-parens z-end z-shell">)</span> <span class="z-punctuation z-section z-braces z-begin z-shell">{</span>
</span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function z-shell">    <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">checkpath</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>file</span><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>mode</span> 0600<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>owner</span> root:root <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>/etc/conf.d/<span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-punctuation z-section z-expansion z-parameter z-begin z-shell">{</span></span><span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-variable z-other z-readwrite z-shell">RC_SVCNAME</span></span><span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-section z-expansion z-parameter z-end z-shell">}</span></span><span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span>
</span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function z-shell">    <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">checkpath</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>file</span><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>mode</span> 0644<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>owner</span> minio:minio <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>/var/log/<span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-punctuation z-section z-expansion z-parameter z-begin z-shell">{</span></span><span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-variable z-other z-readwrite z-shell">RC_SVCNAME</span></span><span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-section z-expansion z-parameter z-end z-shell">}</span></span>.log<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span>
</span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function z-shell">    <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">checkpath</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>directory</span><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>mode</span> 0700<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>owner</span> minio:minio <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span><span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">MINIO_VOLUME</span></span><span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span>
</span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function z-shell"><span class="z-punctuation z-section z-braces z-end z-shell">}</span></span>
</span></code></pre><p>Nie zapomnij ustawiÄ‡ uprawnieÅ„ wykonywania:<pre class="language-bash z-code" data-lang=bash><code class=language-bash data-lang=bash><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">chmod</span></span><span class="z-meta z-function-call z-arguments z-shell"> +x /etc/init.d/minio</span>
</span></code></pre><h2 id=konfiguracja-serwera-minio>Konfiguracja serwera MinIO</h2><p><strong>WaÅ¼ne:</strong> Upewnij siÄ™, Å¼e twÃ³j Mikrusowy storage jest zamontowany jako <em>/storage</em>.<p>StwÃ³rz plik <em>/etc/conf.d/minio</em> (jako root) i umieÅ›Ä‡ w nim nastÄ™pujÄ…cÄ… zawartoÅ›Ä‡:<pre class="language-bash z-code" data-lang=bash><code class=language-bash data-lang=bash><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell"> Å›cieÅ¼ka do caÅ‚ego "Å›rodowiska" S3</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">MINIO_VOLUME</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell"><span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>/storage/S3<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span>
</span><span class="z-source z-shell z-bash">
</span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell"> nazwa uÅ¼ytkownika administratora</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-storage z-modifier z-shell">export</span> <span class="z-variable z-other z-readwrite z-assignment z-shell">MINIO_ROOT_USER</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell">lemonsh</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell"> hasÅ‚o administratora</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-storage z-modifier z-shell">export</span> <span class="z-variable z-other z-readwrite z-assignment z-shell">MINIO_ROOT_PASSWORD</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell">WysmieniteHaslo</span></span>
</span><span class="z-source z-shell z-bash">
</span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell"> porty TCP, zmieÅ„ jeÅ›li potrzebujesz</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">MINIO_ADDR</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell">:9000</span> <span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell"> gÅ‚Ã³wny port</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">MINIO_CONSOLE_ADDR</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell">:9001</span> <span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell"> MinIO Console</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash">
</span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell"> ustaw tutaj adres za pomocÄ… ktÃ³rego moÅ¼na dostaÄ‡ siÄ™ do MinIO Console z zewnÄ…trz</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-storage z-modifier z-shell">export</span> <span class="z-variable z-other z-readwrite z-assignment z-shell">MINIO_BROWSER_REDIRECT_URL</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell">https://console.minio.example.com:12345</span></span>
</span><span class="z-source z-shell z-bash">
</span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell"> nie powinieneÅ›/aÅ› musieÄ‡ tego zmieniaÄ‡</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-storage z-modifier z-shell">export</span> <span class="z-variable z-other z-readwrite z-assignment z-shell">MINIO_SERVER_URL</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell">http://127.0.0.1<span class="z-meta z-group z-expansion z-parameter z-shell"><span class="z-punctuation z-definition z-variable z-shell">$</span><span class="z-variable z-other z-readwrite z-shell">MINIO_ADDR</span></span></span></span>
</span></code></pre><p>ZmieÅ„ odpowiednie wartoÅ›ci zgodnie z ich opisem w komentarzach.<h2 id=konfiguracja-reverse-proxy>Konfiguracja reverse proxy</h2><p>MinIO posiada swÃ³j wÅ‚asny webowy panel kontrolny zwany MinIO Console, ktÃ³ry wystawiony jest przez port <em>inny</em> od gÅ‚Ã³wnego. Zatem, MinIO w zasadzie wystawia dwie osobne usÅ‚ugi HTTP na osobnych portach. Aby wystawiÄ‡ je do internetu, moÅ¼emy uÅ¼yÄ‡ <em>nginx</em>.<p>Nie bÄ™dÄ™ tutaj opisywaÅ‚ caÅ‚ej konfiguracji samego nginxa, a jedynie samÄ… czÄ™Å›Ä‡ configu ktÃ³ra bÄ™dzie ci potrzebna:<pre class="language-conf z-code" data-lang=conf><code class=language-conf data-lang=conf><span class="z-source z-genconfig"><span class="z-storage z-type z-genconfig">server </span>{
</span><span class="z-source z-genconfig"><span class="z-meta z-comment z-genconfig">    <span class="z-comment z-line z-number-sign z-genconfig"># zamieÅ„ 12345 na port zewnÄ™trzny (patrz "Porty uÅ¼yte w poradniku")
</span></span></span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig">    <span class="z-variable z-parameter z-genconfig">listen</span> </span><span class="z-constant z-numeric z-genconfig">12345</span> ssl; 
</span><span class="z-source z-genconfig"><span class="z-meta z-comment z-genconfig">    <span class="z-comment z-line z-number-sign z-genconfig"># zamieÅ„ example.com na swojÄ… domenÄ™
</span></span></span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig">    <span class="z-variable z-parameter z-genconfig">server_name</span> </span>minio<span class="z-keyword z-operator z-genconfig">.</span>example<span class="z-keyword z-operator z-genconfig">.</span>com;
</span><span class="z-source z-genconfig">    
</span><span class="z-source z-genconfig"><span class="z-meta z-comment z-genconfig">    <span class="z-comment z-line z-number-sign z-genconfig"># ustaw tutaj Å›cieÅ¼ki do certyfikatu SSL
</span></span></span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig">    <span class="z-variable z-parameter z-genconfig">ssl_certificate</span> </span><span class="z-keyword z-operator z-genconfig">/</span>etc<span class="z-keyword z-operator z-genconfig">/</span>ssl<span class="z-keyword z-operator z-genconfig">/</span>minio<span class="z-keyword z-operator z-genconfig">/</span>public<span class="z-keyword z-operator z-genconfig">.</span>crt;
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig">    <span class="z-variable z-parameter z-genconfig">ssl_certificate_key</span> </span><span class="z-keyword z-operator z-genconfig">/</span>etc<span class="z-keyword z-operator z-genconfig">/</span>ssl<span class="z-keyword z-operator z-genconfig">/</span>minio<span class="z-keyword z-operator z-genconfig">/</span>private<span class="z-keyword z-operator z-genconfig">.</span>key;
</span><span class="z-source z-genconfig">
</span><span class="z-source z-genconfig"><span class="z-meta z-comment z-genconfig">    <span class="z-comment z-line z-number-sign z-genconfig"># opcjonalnie, tu moÅ¼esz ustawiÄ‡ maksymalny rozmiar pliku, np. 100m
</span></span></span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig">    <span class="z-variable z-parameter z-genconfig">client_max_body_size</span> </span><span class="z-constant z-numeric z-genconfig">0</span>;
</span><span class="z-source z-genconfig">
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig">    <span class="z-variable z-parameter z-genconfig">ignore_invalid_headers</span> </span><span class="z-constant z-language z-genconfig">off</span>;
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig">    <span class="z-variable z-parameter z-genconfig">proxy_buffering</span> </span><span class="z-constant z-language z-genconfig">off</span>;
</span><span class="z-source z-genconfig">
</span><span class="z-source z-genconfig"><span class="z-keyword z-other z-genconfig">    location</span> <span class="z-keyword z-operator z-genconfig">/</span> {
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig">        <span class="z-variable z-parameter z-genconfig">proxy_set_header</span> </span><span class="z-support z-constant z-genconfig">X</span><span class="z-keyword z-operator z-genconfig">-</span>Real<span class="z-keyword z-operator z-genconfig">-</span><span class="z-support z-constant z-genconfig">IP</span> <span class="z-storage z-source z-genconfig">$remote_addr</span>;
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig">        <span class="z-variable z-parameter z-genconfig">proxy_set_header</span> </span><span class="z-support z-constant z-genconfig">X</span><span class="z-keyword z-operator z-genconfig">-</span>Forwarded<span class="z-keyword z-operator z-genconfig">-</span>For <span class="z-storage z-source z-genconfig">$proxy_add_x_forwarded_for</span>;
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig">        <span class="z-variable z-parameter z-genconfig">proxy_set_header</span> </span><span class="z-support z-constant z-genconfig">X</span><span class="z-keyword z-operator z-genconfig">-</span>Forwarded<span class="z-keyword z-operator z-genconfig">-</span>Proto <span class="z-storage z-source z-genconfig">$scheme</span>;
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig">        <span class="z-variable z-parameter z-genconfig">proxy_set_header</span> </span>Host <span class="z-storage z-source z-genconfig">$http_host</span>;
</span><span class="z-source z-genconfig">
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig">        <span class="z-variable z-parameter z-genconfig">proxy_connect_timeout</span> </span><span class="z-constant z-numeric z-genconfig">300</span>;
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig">        <span class="z-variable z-parameter z-genconfig">proxy_http_version</span> </span><span class="z-constant z-numeric z-genconfig">1</span><span class="z-keyword z-operator z-genconfig">.</span><span class="z-constant z-numeric z-genconfig">1</span>;
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig">        <span class="z-variable z-parameter z-genconfig">proxy_set_header</span> </span>Connection <span class="z-string z-quoted z-double z-genconfig">""</span>;
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig">        <span class="z-variable z-parameter z-genconfig">chunked_transfer_encoding</span> </span><span class="z-constant z-language z-genconfig">off</span>;
</span><span class="z-source z-genconfig">
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig">        <span class="z-variable z-parameter z-genconfig">proxy_pass</span> </span><span class="z-meta z-url z-genconfig"><span class="z-constant z-other z-genconfig">http://127.0.0.1:9000</span></span>;<span class="z-meta z-comment z-genconfig"> <span class="z-comment z-line z-number-sign z-genconfig"># zmieÅ„ 9000 na port *gÅ‚Ã³wny* (jeÅ›li siÄ™ rÃ³Å¼ni)
</span></span></span><span class="z-source z-genconfig">    }
</span><span class="z-source z-genconfig">}
</span><span class="z-source z-genconfig">
</span><span class="z-source z-genconfig"><span class="z-storage z-type z-genconfig">server </span>{
</span><span class="z-source z-genconfig"><span class="z-meta z-comment z-genconfig">    <span class="z-comment z-line z-number-sign z-genconfig"># zamieÅ„ 12345 na port zewnÄ™trzny (patrz "Porty uÅ¼yte w poradniku")
</span></span></span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig">    <span class="z-variable z-parameter z-genconfig">listen</span> </span><span class="z-constant z-numeric z-genconfig">12345</span> ssl; 
</span><span class="z-source z-genconfig"><span class="z-meta z-comment z-genconfig">    <span class="z-comment z-line z-number-sign z-genconfig"># zamieÅ„ example.com na swojÄ… domenÄ™
</span></span></span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig">    <span class="z-variable z-parameter z-genconfig">server_name</span> </span>console<span class="z-keyword z-operator z-genconfig">.</span>minio<span class="z-keyword z-operator z-genconfig">.</span>example<span class="z-keyword z-operator z-genconfig">.</span>com;
</span><span class="z-source z-genconfig">    
</span><span class="z-source z-genconfig"><span class="z-meta z-comment z-genconfig">    <span class="z-comment z-line z-number-sign z-genconfig"># ustaw tutaj Å›cieÅ¼ki do certyfikatu SSL
</span></span></span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig">    <span class="z-variable z-parameter z-genconfig">ssl_certificate</span> </span><span class="z-keyword z-operator z-genconfig">/</span>etc<span class="z-keyword z-operator z-genconfig">/</span>ssl<span class="z-keyword z-operator z-genconfig">/</span>minio<span class="z-keyword z-operator z-genconfig">/</span>public<span class="z-keyword z-operator z-genconfig">.</span>crt;
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig">    <span class="z-variable z-parameter z-genconfig">ssl_certificate_key</span> </span><span class="z-keyword z-operator z-genconfig">/</span>etc<span class="z-keyword z-operator z-genconfig">/</span>ssl<span class="z-keyword z-operator z-genconfig">/</span>minio<span class="z-keyword z-operator z-genconfig">/</span>private<span class="z-keyword z-operator z-genconfig">.</span>key;
</span><span class="z-source z-genconfig">
</span><span class="z-source z-genconfig"><span class="z-meta z-comment z-genconfig">    <span class="z-comment z-line z-number-sign z-genconfig"># opcjonalnie, tu moÅ¼esz ustawiÄ‡ maksymalny rozmiar pliku, np. 100m
</span></span></span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig">    <span class="z-variable z-parameter z-genconfig">client_max_body_size</span> </span><span class="z-constant z-numeric z-genconfig">0</span>;
</span><span class="z-source z-genconfig">
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig">    <span class="z-variable z-parameter z-genconfig">ignore_invalid_headers</span> </span><span class="z-constant z-language z-genconfig">off</span>;
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig">    <span class="z-variable z-parameter z-genconfig">proxy_buffering</span> </span><span class="z-constant z-language z-genconfig">off</span>;
</span><span class="z-source z-genconfig">
</span><span class="z-source z-genconfig"><span class="z-keyword z-other z-genconfig">    location</span> <span class="z-keyword z-operator z-genconfig">/</span> {
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig">        <span class="z-variable z-parameter z-genconfig">proxy_set_header</span> </span><span class="z-support z-constant z-genconfig">X</span><span class="z-keyword z-operator z-genconfig">-</span>Real<span class="z-keyword z-operator z-genconfig">-</span><span class="z-support z-constant z-genconfig">IP</span> <span class="z-storage z-source z-genconfig">$remote_addr</span>;
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig">        <span class="z-variable z-parameter z-genconfig">proxy_set_header</span> </span><span class="z-support z-constant z-genconfig">X</span><span class="z-keyword z-operator z-genconfig">-</span>Forwarded<span class="z-keyword z-operator z-genconfig">-</span>For <span class="z-storage z-source z-genconfig">$proxy_add_x_forwarded_for</span>;
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig">        <span class="z-variable z-parameter z-genconfig">proxy_set_header</span> </span><span class="z-support z-constant z-genconfig">X</span><span class="z-keyword z-operator z-genconfig">-</span>Forwarded<span class="z-keyword z-operator z-genconfig">-</span>Proto <span class="z-storage z-source z-genconfig">$scheme</span>;
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig">        <span class="z-variable z-parameter z-genconfig">proxy_set_header</span> </span>Host <span class="z-storage z-source z-genconfig">$http_host</span>;
</span><span class="z-source z-genconfig">
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig">        <span class="z-variable z-parameter z-genconfig">proxy_connect_timeout</span> </span><span class="z-constant z-numeric z-genconfig">300</span>;
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig">        <span class="z-variable z-parameter z-genconfig">proxy_http_version</span> </span><span class="z-constant z-numeric z-genconfig">1</span><span class="z-keyword z-operator z-genconfig">.</span><span class="z-constant z-numeric z-genconfig">1</span>;
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig">        <span class="z-variable z-parameter z-genconfig">proxy_set_header</span> </span>Connection <span class="z-string z-quoted z-double z-genconfig">""</span>;
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig">        <span class="z-variable z-parameter z-genconfig">chunked_transfer_encoding</span> </span><span class="z-constant z-language z-genconfig">off</span>;
</span><span class="z-source z-genconfig">
</span><span class="z-source z-genconfig"><span class="z-meta z-param z-genconfig">        <span class="z-variable z-parameter z-genconfig">proxy_pass</span> </span><span class="z-meta z-url z-genconfig"><span class="z-constant z-other z-genconfig">http://127.0.0.1:9001</span></span>;<span class="z-meta z-comment z-genconfig"> <span class="z-comment z-line z-number-sign z-genconfig"># zmieÅ„ 9001 na port *konsoli* (jeÅ›li siÄ™ rÃ³Å¼ni)
</span></span></span><span class="z-source z-genconfig">    }
</span><span class="z-source z-genconfig">}
</span></code></pre><p>ZmieÅ„ odpowiednie wartoÅ›ci zgodnie z ich opisem w komentarzach.<p>Nie zapomnij zrestartowaÄ‡ nginxa:<pre class="language-bash z-code" data-lang=bash><code class=language-bash data-lang=bash><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">service</span></span><span class="z-meta z-function-call z-arguments z-shell"> nginx restart</span>
</span></code></pre><h1 id=e-dziala-to>E, dziaÅ‚a to?</h1><p>Upewnij siÄ™, Å¼e konfiguracja jest prawidÅ‚owa i uruchom MinIO:<pre class="language-bash z-code" data-lang=bash><code class=language-bash data-lang=bash><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">service</span></span><span class="z-meta z-function-call z-arguments z-shell"> minio start</span>
</span></code></pre><p>JeÅ›li nie pojawiÄ… siÄ™ Å¼adne bÅ‚Ä™dy, wejdÅº na adres <em>https://console.minio.twojadomena.pl:12345</em>. JeÅ›li instalacja przebiegÅ‚a bezbÅ‚Ä™dnie, powinieneÅ› zobaczyÄ‡ interfejs logowania do MinIO Console. UÅ¼yj wczeÅ›niej ustalonych poÅ›wiadczeÅ„ (<em>Konfiguracja serwera MinIO</em>).<p>DziaÅ‚a?<ul><li>JeÅ›li tak, gratulacje!<li>JeÅ›li nie, jak coÅ› logi sÄ… w <em>/var/log/minio.log</em>, powodzenia!</ul><script async crossorigin data-category=Posts data-category-id=DIC_kwDOGenHOs4CBSqT data-emit-metadata=0 data-input-position=bottom data-lang=en data-mapping=pathname data-reactions-enabled=1 data-repo=lemon-sh/lemonsh.moe data-repo-id=R_kgDOGenHOg data-theme=transparent_dark src=https://giscus.app/client.js></script><hr><a class=footer href=#>â†‘ top â†‘</a>